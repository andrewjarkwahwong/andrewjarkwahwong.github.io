<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https://andrewjarkwah.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://andrewjarkwah.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2025-01-20T22:29:18+00:00</updated><id>https://andrewjarkwah.github.io/feed.xml</id><title type="html">blank</title><subtitle>A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">Analytical Grand Canonical DFT - Specific Anion Adsorption</title><link href="https://andrewjarkwah.github.io/blog/2024/specificanionads-copy/" rel="alternate" type="text/html" title="Analytical Grand Canonical DFT - Specific Anion Adsorption"/><published>2024-08-07T15:12:00+00:00</published><updated>2024-08-07T15:12:00+00:00</updated><id>https://andrewjarkwah.github.io/blog/2024/specificanionads%20copy</id><content type="html" xml:base="https://andrewjarkwah.github.io/blog/2024/specificanionads-copy/"><![CDATA[<h1 id="overview">Overview</h1> <p>Here I will go incorporating charge separation (or electrification) interactions of specifically adsorbed anions within an electrochemical double layer (EDL). I will briefly go through some theory and the aGC-DFT approach, as well</p> <h1 id="1-base-models-of-acetate-adsorption-low-and-high-ph">1. Base Models of Acetate Adsorption: Low and High pH</h1> <h2 id="monovalent">Monovalent</h2> <p>Here, I review the basic derivations of anion adsorption without EDL considerations. <a href="https://andrewjarkwahwong.github.io/blog/2024/specificanionads/">More detailed derivations and basics are discussed in my previous blog posts.</a></p> <h3 id="high-ph">High pH</h3> <p>When the pH is greater than the pKa of the acid of interest, anions are present due to the lack of proton concentration. Thus, the reaction to specifically adsorb anions on the metal is given as:</p> \[A^-_{(aq)}+ * \rightarrow A^*_{(aq)} + e^- (1)\] <p>The equilibrium adsorption potential is the electrode potential where this reaction is at equilibrium. Thus, the free energy of the reaction solved at the equilibrium adsorption potential is given as:</p> \[\Delta G_{ads}(U^0_{abs})=0=G_{A^*_{(g)}} -|e|U^0_{abs} - G_{A^-_{(g)}} - G_{*_{(g)}}+\Delta\Delta G_{solv} (2)\] <p>and the equilibrium adsorption potential for when the pH is above the pKa is given as:</p> \[U^0_{abs} = \frac{G_{A^*_{(g)}} - G_{A^-_{(g)}} - G_{*_{(g)}}+\Delta\Delta G_{solv}}{|e|} (3)\] <p>where this equilibrium potential can be converted to an experimentally relevant scale (ex: SHE).</p> <h3 id="low-ph">Low pH</h3> <p>When the pH is below the pKa, there is a high proton concentration. Thus, “anions” are in the form as the undissociated acid (HA). The equation for the acid adsorb is given as:</p> \[HA_{(aq)}+ * \rightarrow A^*_{(aq)} + e^- + H^+ (4)\] <p>The Computational Hydrogen Electrode is used to approximate the free energy of the proton and electron pair, resulting in the free energy change to be:</p> \[\Delta G_{ads}(U_{RHE})=G_{A^*_{(g)}} + \frac{1}{2}G_{H_2,(g)} - |e|U_{RHE}- G_{HA_{(g)}} - G_{*} +\Delta\Delta G_{solv} (5)\] <p>which sets the potential on a RHE scale. The equilibrium potential can be solved analogously as shown in the high pH case. Alternatively, the RHE and SHE are related by the Nernstian change in the pH:</p> \[U_{RHE} = U_{SHE} - 0.059pH(6)\] <p>where Eq. 5 is written based on the SHE scale and the resulting form is given as Equation 7.</p> \[\Delta G_{ads}(U_{SHE})=G_{A^*_{(g)}} + \frac{1}{2}G_{H_2,(g)} - |e|U_{SHE} + 0.059pH- G_{HA_{(g)}} - G_{*} +\Delta\Delta G_{solv} (7)\] <p>The equilibrium adsorption potential can be solved similarly for when the reaction is at equilibrium, which nets the following:</p> \[U^0_{SHE} = \frac{G_{A^*_{(g)}} + \frac{1}{2}G_{H_2,(g)} + 0.059pH- G_{HA_{(g)}} - G_{*} +\Delta\Delta G_{solv}}{|e|} (8)\] <p>where the equilibrium adsorption potential is pH dependent based on a Nernstanian shift.</p> <h2 id="non-monovalent-anions">Non-monovalent Anions</h2> <p>Anions are certainly not only present as monovalent species. The following are brief derivations for the non-monovalent cases.</p> <h3 id="divalent">Divalent</h3> <p>Here I derive specific anion adsorption as for a divalent anion as a simple example.</p> <p>When the <strong>pH &gt; pKa</strong>, the divalent adsorbs onto the metal as:</p> \[A^{2-} + * \rightarrow A* + 2e^- (9)\] <p>When the <strong>pH &lt; pKa</strong>, the diprotic adsorbs onto the metal as:</p> \[H_2A + * \rightarrow A^* +2(e^- + H^+) \;\;\;(10)\] <p>The procedure to solve for the equilibrium adsorption potential is the same as for the monovalent case.</p> <h3 id="general-form">General Form</h3> <p>Based on the divalent case, the adsorption of any polyvalent anion can be written in the following Equations 11 and 12.</p> \[A^{n-} + * \rightarrow A* + ne^- (11)\] \[H_nA + * \rightarrow A^* +n(e^- + H^+)\;\;\; (12)\] <p>where Equation 11 is applicable for when the <strong>pH &gt; pKa</strong> and Equation 12 is applicable when the <strong>pH&lt;pKa.</strong> The equilibrium adsorption potential for when the <strong>pH&gt;pKa</strong> can then be calculated as:</p> \[\Delta G_{ads}(U^0_{abs})=0=G_{A^*_{(g)}} -n|e|U^0_{abs} - G_{A^-_{(g)}} - G_{*_{(g)}}+\Delta\Delta G_{solv} (13a)\] \[U^0_{abs} = \frac{G_{A^*_{(g)}} - G_{A^-_{(g)}} - G_{*_{(g)}}+\Delta\Delta G_{solv}}{n|e|} (13b)\] <p>When the <strong>pH&lt;pKa</strong>, the equilibrium adsorption potential is calculated as:</p> \[\Delta G_{ads}(U_{RHE})=G_{A^*_{(g)}} + n(\frac{1}{2}G_{H_2,(g)} - |e|U_{RHE})- G_{HA_{(g)}} - G_{*} +\Delta\Delta G_{solv} (14a)\] \[\Delta G_{ads}(U_{SHE})=G_{A^*_{(g)}} + n(\frac{1}{2}G_{H_2,(g)} - |e|U_{SHE} + 0.059pH) - G_{HA_{(g)}} - G_{*} +\Delta\Delta G_{solv} (14 b)\] \[U^0_{SHE} = \frac{G_{A^*_{(g)}} + n(\frac{1}{2}G_{H_2,(g)} + 0.059pH)- G_{HA_{(g)}} - G_{*} +\Delta\Delta G_{solv}}{n|e|} (14c)\] <h1 id="2-implementing-edl-effects-using-analytical-grand-canonical-dft">2. Implementing EDL effects using Analytical Grand Canonical DFT</h1> <p>Previously in Section 1, we did not incorporate the influence of electrification at the electrochemical double layer during the specific adsorption of an anion. Here in Section 2, we will discuss how to incorporate the influence of the EDL on 1) predicted equilibrium adsorption potential and 2) the electrosorption valency. We do this by incorporating these correction to constant potential and the electrification influence using our analytical Grand Canonical DFT framework (aGC-DFT).</p> <p>While I briefly go over this model, detailed derivations and its applications of aGC-DFT should be done in our <a href="https://www.sciencedirect.com/science/article/abs/pii/S0021951724000733">Journal of Catalysis paper</a> and <a href="https://pubs.acs.org/doi/10.1021/acs.jpcc.4c01457">our Journal of Physical Chemistry paper of its applications for barriers.</a> Additionally, <a href="https://andrewjarkwahwong.github.io/blog/2024/GCDFTbasics/">a recent blog post I recently published further discusses the dilemma of correcting our simulations to “constant potential” to accurately model electrocatalysis.</a></p> <h2 id="21-equilibrium-adsorption-potential">2.1 Equilibrium Adsorption Potential</h2> <h3 id="analytical-grand-canonical-dft-correction-of-reaction-states">Analytical Grand Canonical DFT correction of Reaction States</h3> <p>The goal is to correct the free energy of either the adsorbed anion (A*) or the bare metal surface with EDL considerations. <a href="https://andrewjarkwahwong.github.io/blog/2024/GCDFTbasics/">From the previous blog post,</a> the Grand Canonical free energy of any reaction state, $\lambda$, with electrification considerations within the EDL and corrected to a potential is given as:</p> \[\Omega_{\lambda}(U) =G_{\lambda}(U) = G_{\lambda}(U_{pzc,\lambda})+E_{charging}+E_{field-ads}\; (15)\] <p>where \(G_{\lambda}(U_{pzc,\lambda})\) is the free energy based on the “vacuum” DFT simulation of the reaction state \(\lambda\), \(E_{charging}\) is the energy to charge the potential of reaction state \(\lambda\), to the potential of interest (\(U\)), and \(E_{field-ads}\) is the field adsorbate interactions. From the previous blog post, we will assume a potential-independent capacitance to charge the reaction state to \(U\) for simplicity, which yields:</p> \[E_{charging}=-\frac{1}{2}C(U-U_{pzc,\lambda})^2 \; (16)\] <p>where derivations for potential-dependent capacitance or charging energy is derived in the previous post. The field adsorbate interactions is given as a truncated second order Taylor’s expansion of the Energy w.r.t field as:</p> \[E(F)=E_{F=0}+\frac{dE}{dF}F+\frac{1}{2} \frac{d^2E}{dF^2}F^2+...\; (17a)\] \[E(F)=E_{F=0}+\mu_{(F=0)} F+\frac{1}{2} \alpha F^2+...\; (17b)\] <p>where \(F\) is the Electric Field, \(E_{F=0}\) is the DFT energy at \(F\)=0, \(\mu_{(F=0)}\) is dipole moment of the reaction state when \(F\)=0, and \(\alpha\) is the polarizability of the reaction state. The dipole moment and the \(E_{F=0}\) are easily attained from a “stock” DFT simulation. Procedures for the polarizability requires a fitting procedure, <a href="https://www.sciencedirect.com/science/article/abs/pii/S0021951724000733">which is explained in our prior work in the SI.</a>. Essentially, the last two terms describes the energy contributions of the surface dipole interacting with an electric field and the induced surface dipole with an electric field.</p> <p>Combining all of these contributions yield the fully corrected Grand Canonical Free Energy of a particular state as:</p> \[\Omega_{\lambda}(U) =G_{\lambda}(U) = G_{\lambda}(U_{pzc,\lambda})-\frac{1}{2}C(U-U_{pzc,\lambda})^2+\mu_{(F=0)} F+\frac{1}{2} \alpha F^2\; (18)\] <p>where the reaction state now considers 1) charging to the correct potential based on a potential-independent capacitance and 2) the field-adsorbate interactions to a second term.</p> <h3 id="edl-model-of-choice-and-calculating-equilibrium-adsorption-potentials">EDL model of Choice and Calculating Equilibrium Adsorption Potentials</h3> <p>The final puzzle piece to utilizing Equation 18 is recognizing that the capacitance and the field requires a description of the EDL, which this is generally unknown. Here we assume a classical Helmholtz model due to its simplicity in approximating the capacitance and the field as:</p> \[C = \frac{\epsilon_r \epsilon_0 A}{d}\;(19)\] \[F=\frac{U-U_{pzc,\lambda}}{d}\;(20)\] <p>where the relative permittivity (dielectric constant) of the Helmholtz EDL is \(\epsilon_r\), and the vacuum permittivity is $\epsilon_0$, A is the area of the DFT slab, and d is the Helmholtz EDL width. <a href="https://andrewjarkwahwong.github.io/blog/2024/Basics-of-Electrochemical-Double-Layer-Models/">To learn more about the intricacies of the EDL and current models, my recent blog post covers this topic.</a> Here, we know all the parameters <strong>except the dielectric constant of the EDL and the distance of the Helmholtz EDL</strong>. However, the <strong>powerful advantage of this approach is to be able to approximate the capacitance and field by guessing different values of the dielectric constant and EDL width.</strong></p> <p>Combining Eqs. 18, 19, and 20 yields the final equation to correcting the Reaction State Free energy based on a Helmholtz Model as:</p> \[\Omega_{\lambda}(U) = G_{\lambda}(U_{pzc,\lambda})-\frac{1}{2}\frac{\epsilon_r \epsilon_0 A}{d}(U-U_{pzc,\lambda})^2+\mu_{(F=0)} \frac{U-U_{pzc,\lambda}}{d}+\frac{1}{2} \alpha (\frac{U-U_{pzc,\lambda}}{d})^2\; (21)\] <p>This may look complicated but luckily a code is provided in the former sections to tabulate all of these values. Additionally, by guessing different values of \(\epsilon_r\) and \(d\), we can calculate the energy of the reaction state with the free energy change. This can be seen for calculating the equilibrium adsorption potential using the monovalent high pH case of Equation 2 as modified as:</p> \[\Delta G_{ads}(U)=\Omega_{A^*_{(g)}}(U) -|e|U - G_{A^-_{(g)}} - \Omega_{*_{(g)}}(U)+\Delta\Delta G_{solv} (22a)\] \[\Delta G_{ads}(U^0_{abs})=0=\Omega_{A^*_{(g)}}(U^0_{abs}) -|e|U^0_{abs} - G_{A^-_{(g)}} - \Omega_{*_{(g)}}(U^0_{abs})+\Delta\Delta G_{solv} (22b)\] <p>where note the \(\Omega\). Now this procedure can be used to calculate the Equilibrium Adsorption potential with EDL considerations.</p> <h2 id="22-electrosorption-valency">2.2 Electrosorption Valency</h2> <p>In section 1, anions are assumed to undergo complete electron transfer. This is seen as A* in Eqs. 1,4,9 and 11. This is true if anions adsorb at a metal surface in <strong>vacuum, where the anion is complete neutralized and under go integer electron transfer.</strong> This is not true when at a non-vacuum interface or specifically at the Electrochemical double layer. This non-integer electron transfer is seen in electrocatalysis experimentally. One can view this non-interge as once the ion adsorbs, it can partially share electrons with the metal (donate or receive) to charge the double layer or interact with the environment. This is seen from the electrosorption valency, a measure of the degree of partial electron transfer to the surface. More readings regarding the electrosorption valency and charge transfer <a href="https://pubs.acs.org/doi/10.1021/la980692t">can be read here.</a></p> <p>The electrosorption valency is the measure of the degree of partial electron transfer to the surface which the formula and its units are given as:</p> \[l = \frac{d\Delta G_{ads}}{dU}[=]\frac{eV}{V}[=]{e}\; (23)\] <p>Using Equations 22a and 23 yields the following equation describing the electrosorption valency of specific anion adsorption:</p> \[l(U) = \frac{d\Delta G_{ads}}{dU}=-|e| + 2\frac{\Delta \mu}{d} - \frac{\Delta (\alpha \mu)}{\epsilon A d^2} + \frac{\Delta \alpha}{d^2}U \;(24)\] <p>where the electrosorption valency depends on the dipole moment and polarizability changes between the adsorbed anion state and the bare metal surface. If the anion had no dipole moment and polarizability change upon adsorption (the last three terms are neglect), the electrosorption valency is negative one, indicating the one whole electron is transferred from the surface to the ion and the anion is neutralized. If the anion has a significant dipole moment and/or polarizability change, the electrosorption valency deviates from negative one. Electrosorption valency values more negative than negative one indicates that the metal transfer more than 1 electron to the anion, thus the anion retains a negative charge. Note that the electrosorption valency becomes potential dependent when the last term is significant aka the polarizability change is significant.</p> <h1 id="3-python-code">3. Python Code</h1> <p>Luckily, I wrote a Python script that uses that analyzes the data above. The script can be found in <a href="https://github.com/andrewjarkwahwong/DFTanionadsorption">the DFTAnionAdsorption GitHub repo.</a> The excel sheet of data needed must be obtained by emailing me at ajwongphd@gmail.com. The code does the following:</p> <ol> <li>Export Data from Excel Sheet using Pandas</li> <li>By specifying the pH and pKa, Calculate Equilibrium adsorption potentials and Electrosorption Valencies for different EDL parameters.</li> <li>Plot the Equilibrium adsorption potentials and electrosorption valencyies across descriptors of interests (here we consider the Work Function, O* binding, and OH* binding.) <h2 id="code-inputs">Code Inputs</h2> <p>Here, I will go over the inputs required in <a href="https://github.com/andrewjarkwahwong/DFTanionadsorption">the Python Script.</a></p> </li> </ol> <h3 id="data-inputs-using-pandas">Data Inputs using Pandas:</h3> <p>First, pandas exports each column of the excel template provided (DFTanionadsorption/ExcelSheets/Acetate_O_OH_Metals_Template.xlsx) as a dataframe to work with the data. The path and the sheet in the excel sheet must be specified. This is shown below.</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">python
</span><span class="c1">#%% Inputs by extracting Excel data
</span>
<span class="c1"># Input Sheet Name and Path below
</span><span class="n">sheet</span> <span class="o">=</span> <span class="sh">'</span><span class="s">111</span><span class="sh">'</span> <span class="c1"># 110 or 111
</span><span class="n">path</span> <span class="o">=</span> <span class="sh">"</span><span class="s">C:/Users/Drew Wong/.../Acetate_O_OH_Metals.xlsx</span><span class="sh">"</span>

<span class="c1">#Code: Imports Data
</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_excel</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet</span><span class="p">)</span>
<span class="p">```</span>
</code></pre></div></div> <p>The rest of the generating the inputs is self-explainatory. Note that the analytical GC-DFT framework does not incorporate explicit solvent considerations. This is easily incorporated as \(\Delta\Delta G_{solv}\) based on whatever treatment of solvation you wish to use. In the code, we assume it to be zero as follows:</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">
</span>g_solv = 0 # Solvation energies are zero for now, can input a list or array
<span class="p">```</span>
</code></pre></div></div> <p>This will need to be changed to be as a list or array for each metal of interest.</p> <h3 id="ph-and-pka">pH and pKa:</h3> <p>Since anion adsorption is dependent on the pH and pKa, these values will need to be user-inputs. This is shown below:</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">
</span># Values of pH
pH=0 #pH to calculate shift 
pKa = 3.76 #Reference pKa 
n = 1 #Valency

# Example Input for pH level
if pH  &gt; pKa:
    pH_level = "high"  # "high" or "low" relative to the pKa of interest
else:
    pH_level = "low"  # "high" or "low" relative to the pKa of interest  

<span class="p">```</span>
</code></pre></div></div> <p>Based on the pH and pKa, it will calculate the equilibrium adsorption differently depending if the pH is greater or less than the pKa as discussed before.</p> <h3 id="potential-range">Potential Range:</h3> <p>Both the equilibrium adsorption potential and especially the electrosorption valency depends on the potential range used. For the allter, this is especially important for the electrosorption valency as it is potential dependent with the full model consideration of the aGC-DFT framework. Here, we calculate an “effective” electrosorption valency over a potential range specified, which is just the average electrosorption valency. The potential range inputs are defined below.</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">
</span>#Potential Range of Interest
u_low = -1 #Lower Potential V-SHE that you input
u_high = 2 #Upper Potential V-SHE 
u = np.linspace(u_low,u_high,25)
<span class="p">```</span>
</code></pre></div></div> <h3 id="edl-parameters">EDL Parameters:</h3> <p>The specified EDL parameters are specified as a list shown below:</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">
</span>er = [1,2,8,13,78.4] #Relative permittivity (Dielectric Constant)
d = [3,4.5,6,10] #Helmholtz EDL Width in Angstrom
<span class="p">```</span>
</code></pre></div></div> <p>Any plausiable value can be used. Note that in the code analysis that the “circle” markers extracts a combination from the specified er and d as shown:</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">
</span>plot_values = [resultsEDL[(2, 3), element]['u0_2c'] for element in elements] #Plot the value of U0 at er = 2 and d=3, which you can change to whatever value
<span class="p">```</span>
</code></pre></div></div> <p>An error will show if the combination chosen isn’t specified previously as these are just stored as a dictionary.</p> <h3 id="conversion-from-absolute-scale-to-the-she">Conversion from absolute scale to the SHE</h3> <p>This conversion needs to be specified as shown below:</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">
</span>vac_nhe = 4.6 #abs to SHE
<span class="p">```</span>
</code></pre></div></div> <p>4.6 is a common value but this can range from 4.2 to 5.2 V.</p> <h2 id="outputs">Outputs</h2> <p>The following examples are the output of this code. Note the marker is the equilibrium potential or electrosorption valency at a specific dielectric constant and EDL width. The error bars are the range of these values for different EDL parameters.</p> <h3 id="equilibrium-adsorption-potentials-correlating-with-metal-descriptors">Equilibrium Adsorption Potentials Correlating with Metal Descriptors</h3> <p>Here the equilibrium adsorption potential (of acetate adsorption) for different dielectric constants and EDL widths are plotted against various metal descriptors. This is shown for the case of (111) late-transition metal surfaces when the pH &lt; pKa. The markers are the equilibrium adsorption potentials at a dielectric constant of 2 and a EDL width of 3 angstroms. Here, we observed that the O* binding may be a potential descriptor for acetate adsorption on (111) metal surfaces.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/UvsM-480.webp 480w,/assets/img/UvsM-800.webp 800w,/assets/img/UvsM-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/UvsM.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="electrosorption-valencies">Electrosorption Valencies</h3> <p>Similarly, the electrosorption valency of acetate adsorbed on different metals is plotted against the same metal descriptors. Note, that the electrosorption valency is usually more negative than -1. If the \(l = -1\) like for Acetate on Ag(111), the adsorbed acetate undergoes approximately one electron transfer from the metal to the anion, neutralizing acetate to have a neutral charge. However, most metals \(l &lt; -1\), indicating that more than one (non-integer) electron is transfered to the anion like on Pt(111) with \(l = -1.2\). This would indicate that surface-bound acetate exhibits a partial negative charge (i.e. -0.2 for Pt(111)). Interestingly, the work function of the metal may be indicative of the propensity of the anion to exhibit a more negative electrosorption valency.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/eVvsM-480.webp 480w,/assets/img/eVvsM-800.webp 800w,/assets/img/eVvsM-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/eVvsM.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h1 id="4-references">4. References</h1> <p>If you enjoyed this post and want to learn more, I have provided additional reading and scripts that are related.</p> <p>Scripts: <a href="https://github.com/andrewjarkwahwong/DFTanionadsorption">Python scripts to replicate this work are placed in the DFTAnionAdsorption GitHub repo.</a></p> <p>Readings: <a href="https://andrewjarkwahwong.github.io/blog/2024/specificanionads/">A review of anion adsorption and its pH dependence is discussed in my previous blog post.</a> <a href="https://pubs.acs.org/doi/10.1021/la980692t">Electrosorption Valency and Partial Charge Transfer in Halides</a> <a href="https://andrewjarkwahwong.github.io/blog/2024/Basics-of-Electrochemical-Double-Layer-Models/">To learn more about the intricacies of the EDL and current models, my recent blog post covers this topic.</a></p>]]></content><author><name></name></author><category term="ion-adsorption"/><category term="anions"/><category term="DFT"/><category term="basics"/><category term="math"/><category term="electrocatalysis"/><category term="formatting"/><category term="code"/><category term="GC-DFT"/><summary type="html"><![CDATA[Using the analytical Grand Canonical DFT framework, we are calculating Equilibrium Potential and the electrosorption valency of specifically adsorbed anions with some code too.]]></summary></entry><entry><title type="html">Basics of Electrochemical Double Layer Models</title><link href="https://andrewjarkwah.github.io/blog/2024/Basics-of-Electrochemical-Double-Layer-Models/" rel="alternate" type="text/html" title="Basics of Electrochemical Double Layer Models"/><published>2024-07-22T15:12:00+00:00</published><updated>2024-07-22T15:12:00+00:00</updated><id>https://andrewjarkwah.github.io/blog/2024/Basics%20of%20Electrochemical%20Double%20Layer%20Models</id><content type="html" xml:base="https://andrewjarkwah.github.io/blog/2024/Basics-of-Electrochemical-Double-Layer-Models/"><![CDATA[<h1 id="overview">Overview</h1> <p style="text-align:center;"> <em>"Opposites Attract." - Unknown?</em> </p> <p>This is a famous quote used in magnets, romance, and even for the topic at hand, electrochemical double layers. Here, we will go over the classical Electrochemical Double Layer models and some brief derivations of how these models were conceived. Since I am glossing over a lot of key math principles, this post is more as an introduction to the vocabulary and fundamental principles of the electrode-electrolyte interface. I will suggest further reading or you can just contact me.</p> <h1 id="1-the-dilemma-how-to-visualize-electrocatalytic-interfaces">1. The dilemma: how to visualize electrocatalytic interfaces?</h1> <p>Electrochemical cells are fundamental in electrochemistry. As shown below, these cells (galvanic or electrolytic) have two half cells that respectively mediate the oxidation and reduction reaction. These are all connected through a closed loop between the two cells, circuits, and the electrolyte that mediate charge transfer within the whole system.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cell-480.webp 480w,/assets/img/cell-800.webp 800w,/assets/img/cell-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/cell.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>This seems elementary but the dilemma at hand is where are the ions at each respectively electrode. It is important to have an understanding of the distribution of ions to design better electrocatalytic systems and understand the fundamental phenomena occurring at these interfaces (ex: cation effects in CO\(_2\) reduction). We know that the charged ions are attracted to oppositely charged electrode (ex: cations attract to the cathode) but where are they distributed? Additionally, how does the distribution differ at the bulk solution electrolyte far away from the electrode versus the electrode-electrolyte interface? What does this interface that is so-called the electrochemical double layer (EDL) look like? Currently, one must recognize that sadly the distribution of ions and the properties of the EDL are quite unknown. However, three classical electrochemical double layer models were developed to answer these questions and provide a foundation of what an “ideal” electrode-electrolyte interface may look like and provide the language to communicate regarding the EDL.</p> <h1 id="2-models-of-the-electrochemical-double-layer">2. Models of the Electrochemical Double Layer</h1> <p>Here, I will go over three classical electrochemical double layer models in order of increasing complexities.</p> <ol> <li>Helmholtz</li> <li>Gouy-Chapman</li> <li>Gouy-Chapman-Stern</li> </ol> <h2 id="21-helmholtz">2.1 Helmholtz</h2> <p>The Helmholtz model in my mind is a basically a sandwich. Your two pieces of bread are the charged metal and the oppositely-charged ions that are electrostatically attracted. Then, a dielectric medium (ex: solvent or vacuum) are trapped between these two “pieces of bread”. This is basically the Helmholtz model.</p> <p>Hermann von Helmholtz recognized that an interface is formed when two phases (the charged solid electrode and the electrolyte) come in contact due to their opposite polarity. The model is analogous to a parallel plate capacitor, where two layers of opposite charges form the interface, representing the charged electrode and the oppositely charge ions (counterions) as shown below.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Helm-480.webp 480w,/assets/img/Helm-800.webp 800w,/assets/img/Helm-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/Helm.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="assumptions">Assumptions</h3> <p>The model is a compact and rigid, where the counter ions are distributed as a planar parallel plate consistent of the charge opposite to the electrode. This assumes that the electric field, \(E\) is constant between the metal and the countercharge, which is written as:</p> \[\frac{d\Psi}{dx} = -E = -\frac{\Psi_m-\Psi_{bulk}}{d}\] <p>The distance where the counter charge planar approaches the surface is defined by \(d\). Within \(d\), the potential, \(\Psi\) , decreases linearly from the potential of the metal, \(\psi_M\), to the potential of the bulk solution or the countercharge, \(\Psi_{bulk}\) . This is due to the planar nature of the countercharges and that the Helmholtz models assumes that these countercharges electrostatically screens the potential. As you can see, the electric field is both dependent on the separation between the countercharge and the metal and a constant value in the Helmholtz model.</p> <p>As mentioned before, the Helmholtz model can be described by a parallel plate capacitator. The capacitance describes the charge across a potential difference as shown as:</p> \[\frac{C}{A}=\frac{\Delta q}{\Delta\Psi}\] <p>The charge is related to the charge density on the electrode as:</p> \[\Delta q= \sigma A\] <p>Using Gauss’ law, the charge density is also related to the electric field, which is constant, as:</p> \[\sigma = \epsilon_r \epsilon_0 E\] <p>where the relative permittivity (dielectric constant) of the Helmholtz EDL is \(\epsilon_r\), and the vacuum permittivity is \(\epsilon_0\). These equations can be combined to show that the capacitance of the EDL is potential-independent as a consequence of the constant electric field (or linear potential drop).</p> \[\frac{C}{A}=\frac{\Delta q}{\Delta\Psi}=\frac{\sigma A}{\Delta\Psi}=\frac{\epsilon_r \epsilon_0 E}{\Delta\Psi}=\frac{\epsilon_r \epsilon_0 \frac{\Delta \Psi}{d}}{\Delta\Psi}\] \[\frac{C}{A} = \frac{\epsilon_r \epsilon_0}{d}\] <p>This shows that the capacitance of the EDL described by the Helmholtz Model is only dependent on the dielectric constant and separation of charge. The Helmholtz model provides a simple framework in understanding electric fields and capacitance within the interface for approximately <strong>a highly concentrated electrolyte.</strong></p> <h3 id="limitations">Limitations</h3> <p>While the Helmholtz model is simple, it ignores a few key aspects:</p> <ul> <li>Diffusion/mixing of ions in solution as the ions are all presumed to be present as a parallel plane</li> <li>Any adsorption on the surface (ions, reactants, etc)</li> <li>Solvent Interactions with the electrode since the solvent is really approximated as a continuum view by the constant dielectric constant</li> </ul> <h2 id="22-gouy-chapman-model">2.2 Gouy-Chapman Model</h2> <p>In real life, the capacitance is both dependent on the potential and the electrolyte composition. Louis Georges Gouy and David Leonard Chapman introduced a <strong>diffuse model</strong> of the double-layer where the charge distribution of ions is dependent on the distance away from the surface as shown below.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/GC-480.webp 480w,/assets/img/GC-800.webp 800w,/assets/img/GC-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/GC.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Here, all ions are allowed to move in solution based on electrostatic interactions competiting with the motions described by Brownian. In other words, the electrostatic attraction between opposite charges is in competition with the thermal motions based on entropy. This model is valid for dilute solutions and minimal polarization at the electrode.</p> <h3 id="assumptions-1">Assumptions</h3> <p>The model utilizes Maxwell-Boltzmann statistics to approximate the distribution of ions, resulting in the applied potential to decrease exponentially from the surface to the bulk solution. The derivation is a bit complicated as the Poisson-Boltzmann differential equations must be solved. However, I will highlight key equations.</p> <p>First, the distribution of ions \(n_i\) are described by a Boltzmann distribution as:</p> \[n_i = n_i^0 exp(\frac{-z_ie\Psi}{kT})\] <p>which approximates the distribution by thermal motion as \(n_i^0\) is the bulk concentration of the ion, e is the unit charge, \(z_i\) is the charge of the ion, k is the Boltzmann constant, and T is the absolute temperature.</p> <p>Now the next parts require solving a boundary condition problem and a set of differential equations. To save everyone the torture from these long derivations, I will provide the next few key equations. Please refer to the first reading I reference later but here are two key equations.</p> <p>First, the applied potential can be solved based on the Gouy-Chapman model as:</p> \[\Psi(x)=\Psi_{metal} exp^{-k_{GC}x}\] <p>which shows how the potential drop relative to the metal exponentially decays as the distance becomes larger away from the surface. Increasing the distance away from the surface induces a larger potential drop. Note that \(k_{GC}\) here is the reciprocal of the thickness of the double layer also described as the Debye length \(\lambda_d\). Larger Debye lengths lead to “less steep” of a potential drop.</p> \[\lambda_d = \frac{1}{k_{GC}} = ({\frac{\epsilon_r\epsilon_0k_B T}{2\sum z_i^2 e^2 \rho}})^{\frac{1}{2}}\] <p>where \(\rho\) is the ion concentration, e is the elementary charge of the electron, and z\(_i\) is the charge of the ion. Larger Debye lengths lead to a “less steep” of a potential drop.</p> <p>The electric field is taken as the negative gradient of the potential as shown before as:</p> \[E(x)=-\nabla \Psi(x)\] <p>Lastly, the differential capacitance is described by a nasty equation as:</p> \[C_{GC}=(\frac{2z^2e^2n_i^0\epsilon_r\epsilon_0}{kT})^{\frac{1}{2}} cosh(\frac{z\epsilon\Psi_{Metal}}{2kT})\] <p>where basically the main take away is the capacitance is now dependent on the applied potential at the metal. I will later show that the capacitance shows a parabolic dependence on the applied potential.</p> <p>I have provided a link to a Google Colab notebook that <a href="https://colab.research.google.com/drive/1NcmwJLPKYepk0BG2QO3KDmuZQJKYKbv7?usp=sharing">models both the potential and capacitance profile as you vary the parameters in a Gouy-Chapman Model.</a></p> <h3 id="limitations-1">Limitations</h3> <p>The Gouy-Chapman model has several following limitations:</p> <ul> <li>It fails for electrolyte’s with high concentrations and metals with large polarization. <ul> <li>The model is only valid for potential differences close to zero and very dilute solutions.</li> </ul> </li> <li>Ions are point charges in thermodynamic equilibrium <ul> <li>This overestimates the distribution of ions to be too concentrated once the surface is polarized sufficiently</li> </ul> </li> <li>The model is mean field so no specific interactions</li> </ul> <h2 id="23-gouy-chapman-stern-model">2.3 Gouy-Chapman-Stern Model</h2> <p>Addressing these concerns, Otto Stern simply just combined the two models together. The Stern or “Helmholtz Layer” is simply suggesting ion’s have a closest approach (based on radius) and outside of this region is the diffuse layer from the Gouy-Chapman model.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/GCS-480.webp 480w,/assets/img/GCS-800.webp 800w,/assets/img/GCS-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/GCS.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="assumptions-2">Assumptions</h3> <p>Ions are assumed to have finite sizes or closest approach and are not point charges within distance d. This is the Stern layer. The ions outside of the stern layer and in the now diffuse layer are point charges. There are two potential drops. One is the linear potential drop in the Stern layer. The latter is the exponential decay described by the Gouy-Chapman model.</p> <p>The major math conclusion from this model is the fact that the capacitance of the entire double-layer can be described by a two capacitors in series for the Stern and Gouy-Chapman portions of the model. This is given as:</p> \[\frac{1}{C}=\frac{1}{C_{Stern}}+\frac{1}{C_{GC}}\] \[C=\frac{C_{Stern}C_{GC}}{C_{Stern}+C_{GC}}\] <p>There are two cases that this model shows. First, if the concentration is high, the double layer is fixed and is represented as the Stern layer. Second, if the concentration is dilute, the double layer is more Gouy-Chapman like. This produces the famous “double hump capacitance” for a ideal polarizable surface in contact with a non-interacting electrolyte.</p> <h1 id="3-outlook">3. Outlook</h1> <p>A summary of the three classical model are shown in the following.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cap-480.webp 480w,/assets/img/cap-800.webp 800w,/assets/img/cap-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/cap.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Here we can see how the capacitance can very between different models of the EDL. Despite the GCS seeming the most reasonable model, even this model lacks agreement experimentally. It does not consider adsorption and chemical reactions at the surface, reactive surfaces with complicated active sites, specific solvent interactions, anisotropic distributions between the ions and solvent outside of the simple mean field approaches, and more. I have provided further reading to touch on these topics. However, the basis of this post is to introduce these models and the intrinsic differences between these models.</p> <p>As always, feel free to reach out if you have any questions and recommendations.</p> <h2 id="future-works-for-myself">Future Works for myself</h2> <ul> <li>Provide a Python script to model the distribution of ions and fields for each model as you change the parameters within the models (dielectric constant, distance, etc)</li> </ul> <h1 id="4-references">4. References</h1> <h2 id="basics-of-edl-models">Basics of EDL models</h2> <ul> <li><a href="https://www.comsol.com/paper/classical-models-of-the-interface-between-an-electrode-and-an-electrolyte-6594">Classic Models of the interface between an electrode and an electrolyte</a></li> <li><a href="chrome-extension://efaidnbmnnnibpcajpcglclefindmkaj/https://www.tvu.edu.in/wp-content/uploads/2019/10/Structure-of-double-layer-Models.pdf">Basic Theories of EDL models</a></li> </ul> <h2 id="advanced-models-of-the-edl">Advanced models of the EDL</h2> <ul> <li><a href="https://www.pnas.org/doi/full/10.1073/pnas.2116016119">An example from Marc Koper of complicated and real capacitance profiles: Double Layer Structure of the Pt (111) - Aqueous Electrolyte Interface</a></li> <li><a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.131.248001">Classical MD simulation studying the anisotropic behavior of the dielectric constant at a Ag-Water interface</a></li> </ul>]]></content><author><name></name></author><category term="electrochemistry"/><category term="EDL"/><category term="basics"/><category term="electrocatalysis"/><category term="math"/><summary type="html"><![CDATA[A brief overview of different models of the electrode-electrolyte interface and the resulting classical electrochemical double layer models.]]></summary></entry><entry><title type="html">The Grand Canonical dilemma of using default DFT simulation to model Electrocatalysis</title><link href="https://andrewjarkwah.github.io/blog/2024/GCDFTbasics/" rel="alternate" type="text/html" title="The Grand Canonical dilemma of using default DFT simulation to model Electrocatalysis"/><published>2024-07-10T15:12:00+00:00</published><updated>2024-07-10T15:12:00+00:00</updated><id>https://andrewjarkwah.github.io/blog/2024/GCDFTbasics</id><content type="html" xml:base="https://andrewjarkwah.github.io/blog/2024/GCDFTbasics/"><![CDATA[<h1 id="overview">Overview</h1> <p>The goal of this blog post is to explain the issue with “default” DFT simulations and how (analytical) Grand Canonical DFT can provide steps closer to achieving “more realistic simulations” for electrocatalysis</p> <h1 id="problems-with-dft-simulations-as-models-for-electrocatalysis">Problems with DFT Simulations as Models for Electrocatalysis</h1> <p>DFT simulations have been instrumental in studying wide range of physics, chemistry, and material science problems. However, determining appropriate DFT simulations for electrocatalysis is challenging. In particular, we will introduce the dilemma that DFT simulations are inherently Canonical simulations (where the number of electrons is constant and the potential is varied) but the electrochemical system we are trying to model is a Grand Canonical (where the number of electrons are varied and the potential is constant). I will briefly introduce the dilemma as well as provide both an electrostatic and thermodynamic derivation to correct DFT energies to Grand Canonical energies. Hopefully, you understand the dilemma and how to approach it.</p> <h2 id="the-dilemma-constant-charge-to-constant-potential">The Dilemma: Constant Charge to Constant Potential</h2> <p>DFT simulations can be seen as a “snapshot” of different ground-energy states along a reaction path. Consider a simple reaction of \(Na^+_{(g)}\) adsorbing onto a metal surface. This reaction can be written as:</p> \[Na^+_{(g)} + * \rightarrow Na* + e^-\] <p>where the free energy change as a function of the applied potential on an absolute scale, \(U_{abs}\) can be defined as:</p> \[\Delta G_{ads}=G_{e^-}+G_{Na*}-G_{*}-G_{Na^+}\] \[\Delta G_{ads}(U_{abs})=-|e|U_{abs}+G_{Na*}-G_{*}-G_{Na^+}\] <p>where solvation is currently neglected. This seems straightforward to calculate as only the free energy of Na*, the bare surface, and the \(Na^+\) in the gas-phase are needed. However, the dilemma of modeling this in a DFT cell is the fact that the simulations are not simulated at the constant and correct potential. This is an artifact of the DFT simulation being constant charge (constant number of electrons) rather than being constant potential. This dilemma is illustrated in the figure below.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ConstantqvsV-480.webp 480w,/assets/img/ConstantqvsV-800.webp 800w,/assets/img/ConstantqvsV-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/ConstantqvsV.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>As seen above, the initial state (the bare metal surface with \(Na^+\) in the gas-phase) is at the potential of zero charge of the bare metal in vacuum (\(U_{pzc,*}\) \(\approx\) 0.5 V-SHE).</p> <p>When we adsorb Na onto the metal, Na donates electrons to the metal. This changes the energy of the electron (fermi energy) and thus, the measured \(U_{pzc,Na*}\) \(\approx\) -0.7 V-SHE.</p> <p>This is an issue as 1) the two states of interest are not compared at the same potentials (not apples-to-apples) and 2) they are not necessarily the potential of interest. This is purely an artifact of the DFT simulation being a canonical simulation.</p> <p>In real life in an actual electrochemical experiment, the potential of these two states or the metal surface is kept at a constant potential by varying the number of electrons. The potentiostat is the tool that essentially injects/removes electrons on the surface to maintain a specific potential. Here, the DFT simulation needs a “computational potentiostat” to correct the simulation to a specific potential as shown in Figure b, essentially modeling a Grand Canonical simulation.</p> <h1 id="grand-canonical-density-functional-theory">Grand Canonical Density Functional Theory</h1> <p>The dilemma is defined but what are the solutions to convert a Canonical DFT simulation to an Grand Canonical simulation? Here, I discuss two ways to understandThen, we briefly discuss the fundamentals and a brief introduction of Grand Canonical DFT methods.</p> <h2 id="the-fundamentals-of-corrections-to-constant-potential">The Fundamentals of Corrections to Constant Potential</h2> <h3 id="electrostatic-explanation">Electrostatic Explanation</h3> <p>A given reaction state,\(\lambda\), can be given in a generalized form and assigned at a potential of zero charge, \(U_{pzc,\lambda}\). This is seen above where the potential of the bare metal surface is \(U_{pzc,*}\) \(\approx\) 0.5 V-SHE and the potential of the Na* is \(U_{pzc,*}\) \(\approx\) -0.7 V-SHE, where \(\lambda\) is respectively * and Na*.</p> <p>Here, we can generally write the corrected Grand Canonical energy of a reaction state, \(\Omega_{\lambda}(U)\), as:</p> \[\Omega_{\lambda}(U) =G_{\lambda}(U) = G_{\lambda}(U_{pzc,\lambda})+E_{charging}\] <p>where \(G_{\lambda}(U_{pzc,\lambda})\) is the free energy of reaction state from the “default” Canonical DFT simulation and \(E_{charging}\) is the energy to charge the reaction state to the correct potential, \(U\). From electrostatics, \(E_{charging}\) is the defined in the general form as:</p> \[E_{charging} = -\int_{q=0}^{q(U)}\frac{q}{C}dq=-\int_{q=0}^{q(U)}Udq\] <p>where \(q\) is the charge and \(C\) is the capacitance. This can be written with the previous equation as:</p> \[\Omega_{\lambda}(U) = G_{\lambda}(U_{pzc,\lambda})-\int_{q=0}^{q(U)}Udq\] <p>where if we knew how the potential difference (voltage) changes as we charge the reaction state, we can correctly charge the reaction state of interest from \(U_{pzc,\lambda}\) to \(U\).</p> <h3 id="thermodynamic-explanation">Thermodynamic Explanation</h3> <p>We cheated a bit before by assuming the energy of the canonical simulation is the Gibbs Free energy. In short, we basically assumed the Helmholtz Free energy and the Gibbs Free energy to be similar because we assume the internal energy,\(E\), and enthalpy,\(H\), are equivalent: \(H=E+PV\) where the constant pressure is assumed.</p> <p>Here, we will use a more thermodynamically correct term of the Helmholtz Free Energy to represent the thermodynamic potential energy of a canonical simulation which is defined as:</p> \[F = E - TS\] <p>where \(E\) is the internal energy, \(T\) is the temperature, and \(S\) is the entropy. The Helmholtz free energy is the thermodynamic potential of a system at thermodynamic equilibrium from which all \(T\) and volume,\(V\) ,are constant. More importantly, the number of electrons or \(N\) are constant.</p> <p>A Grand Canonical simulation is a system at thermodynamic equilibrium where T and \(V\) are constant but the chemical potential of the electrons,\(\mu\), is now constant (or N is non-constant). The Grand Canonical Free energy is given by the general Legendre Transform as:</p> \[\Omega(y) = F(x)-xy\] <p>where for our case it is defined as:</p> \[\Omega(\mu) = F(N)-\mu N\] <p>Here, we converted the Canonical energy to a Grand Canonical energy by performing a legendre transform. The chemical potential represents the change in energy to add or subtract number of electrons. The last term represents the energy to gain or lose electrons as the number of electrons are changed. Once again, if we knew how the chemical potential of the electron changes as we change the number of electrons, we know how to calculate the Grand Canonical Energy.</p> <p>If we take the equation we derived previously based on electrostatics, we can write the following expression that looks quite similar as:</p> \[\Omega(\mu) = F(N)-\mu N \approx G_{\lambda}(U_{pzc,\lambda})-\int_{q=0}^{q(U)}Udq\] <p>where here is the relationship between electrostatics and thermodynamics again if we (confusingly) assume \(F(N)\approx G_{\lambda}(U_{pzc,\lambda})\). Hopefully, this alternative explanation has some help in understanding how we can obtain Grand Canonical Free Energies. FYI, the negative term indicates the adding electrons decreases the energy of the system.</p> <h1 id="explicit-vs-analytical-potentiostats">Explicit vs Analytical Potentiostats</h1> <p>From the derivations, the dilemma remains that we need an approximation of how the approximate the energy to charge a reaction state to a specific potential either from \(-\int_{q=0}^{q(U)}Udq\) or \(-\mu N\). These forms are generally unknown and there are two ways to approximate these terms.</p> <p>First is to explicitly model a potentiostat to approximate the energy to charge the system. I will not go too in depth and further readings are at the end. In a nutshell, there simulation methods that essentially inject or remove electrons in the DFT simulation to correct to the \(U\) defined. If you know how many electrons you added or remove, you know \(N\) and you can approximate \(\mu\) by your description of how the energy cost of adding electrons in vacuum or in a media in the DFT cell that represents the electrolyte. Thus, you can explicitly model DFT simulations at different potentials without the simulation failing or crashing. The disadvantage of these methods are its computational cost and the approximation of the electrolyte that is ill-defined experimentally, which dictations \(\mu\) and \(N\) essentially.</p> <p>The second way is the analytically determine the charging energy. If we assume a potential-independent capacitance, we can derive the energy to charge our DFT reaction state as:</p> \[E_{charging} = -\int_{q=0}^{q(U)}\frac{q}{C}dq=-\frac{1}{2}\frac{q^2}{C}=-\frac{1}{2}C(U-U_{pzc,\lambda})^2\] <p>where now the energy to charge a DFT reaction state to a specific potential based on a potential-independent capacitance is:</p> \[\Omega_{\lambda}(U) = G_{\lambda}(U_{pzc,\lambda})-\frac{1}{2}C(U-U_{pzc,\lambda})^2\] <p>Here, we can calculate the “correct” Grand Canonical potential of any state if we knew the capacitance. This can be estimated experimentally or from simulations. If you wanted to use an expression of a potential-dependent capacitance, you just have to rederive the integral. The advantage of this approach is that you can analytically (without coding into a Fortran VASP simulation) evaluate the Grand Canonical DFT energy. Of course, careful treatment must be considered as this assume that the reaction state at \(U_{pzc,\lambda}\) remains unperturbed at \(U\), which may not be true.</p> <h1 id="outlook-and-further-readings">Outlook and Further Readings</h1> <p>Here we overviewed the dilemma of “default” DFT simulations to model Grand Canonical or Constant potential simulations. We derived both the theory to calculate Grand Canonical DFT simulations and introduced approaches that addresses these dilemmas. To be honest, I left out a lot of well-deserved theory and derivations as well as great work due to 1) keeping this concise and 2) partially I was a lil lazy.</p> <p>For further readings, consider the following:</p> <ul> <li><a href="https://pubs.aip.org/aip/jcp/article/157/18/180902/2842002/Electrochemistry-from-the-atomic-scale-in-the">This paper has great derivations of what I discussed and explicit DFT approaches.</a></li> <li><a href="https://doi.org/10.1002/cphc.202300950">This work also compares between different Grand Canonical DFT approaches</a></li> <li><a href="https://doi.org/10.1016/j.jcat.2024.115360">This is our Analytical DFT paper</a></li> <li><a href="https://pubs.acs.org/doi/10.1021/acs.jctc.3c00836">This paper compares explicit and analytical Grand Canonical DFT approaches</a>):</li> </ul>]]></content><author><name></name></author><category term="GC-DFT"/><category term="GC-DFT"/><category term="DFT"/><category term="basics"/><category term="electrocatalysis"/><category term="math"/><summary type="html"><![CDATA[Default DFT simulations are inherently Canonical simulations. Electrocatalysis (real life) is Grand Canonical. Here we discuss how to correct DFT simulations to represent Grand Canonical Simulations.]]></summary></entry><entry><title type="html">Basics of Equilibrium Anion Adsorption Potentials</title><link href="https://andrewjarkwah.github.io/blog/2024/specificanionads/" rel="alternate" type="text/html" title="Basics of Equilibrium Anion Adsorption Potentials"/><published>2024-07-08T15:12:00+00:00</published><updated>2024-07-08T15:12:00+00:00</updated><id>https://andrewjarkwah.github.io/blog/2024/specificanionads</id><content type="html" xml:base="https://andrewjarkwah.github.io/blog/2024/specificanionads/"><![CDATA[<h1 id="overview">Overview:</h1> <p>The goal of this blog post is to <ins>Calculate potential and pH-dependent equilibrium potentials of anion specific adsorption on metals using DFT.</ins></p> <h1 id="review-pka-and-ph">Review: pKa and pH</h1> <p>The adsorption of anions are dependent on the pH of the solution. The acid dissociation constant, Ka, is crucial in understanding the form of the anion upon adsorption at the surface. The strength of the acid is based on the equilibrium constant of acid dissociation given as:</p> \[HA_{(aq)} \leftrightarrow A^-_{(aq)} + H^+_{(aq)}\] <p>where \(A^-\) is the conjugate base of the acid and \(H^+\) is the proton in solution. All species are in the solution-phase for clarity. The equilibrium constant, \(K_a\), is defined as:</p> \[K_a = \frac{[A^-][H^+]}{[HA]}\] <p>where a higher Ka corresponds to a stronger acid (more dissociated at equilibrium). Assuming concentrations are sufficient for an ideal solution (activities are equivalent to the concentrations), the pKa is defined as:</p> \[pK_a = -log_{10}K_a\] <p>where this convenient scale defines lower pK\(_a\) as stronger acids (larger Ka).</p> <h2 id="ideality-and-activities">Ideality and Activities</h2> <p>Note that ideality was assumed, where concentrations are sufficient [X]. In a solution with varying ionic strengths, temperatures, compositions, and pressures, this is assumption is not always true. The Figure below shows a case of acetic acid is dependent on the ionic strength, where ideality deviates with stronger ionic solutions.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/PK_acetic_acid-480.webp 480w,/assets/img/PK_acetic_acid-800.webp 800w,/assets/img/PK_acetic_acid-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/PK_acetic_acid.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>The activity is a measure of the “effective concentration” or “real concentration”. In the simplest form, the activity of any species at equilibrium is defined as:</p> \[\{X\}=[X]\gamma_X\] <p>where the general form of the activity of any species is given as {X}. The activity coefficient,\(\gamma\), measures the ideality of species X. An activity coefficient of one indicates complete ideality.</p> <p>Ka can be corrected by using the activity coefficients of each species can be corrected to account for the non-ideality of the solution as follows:</p> \[K^\Theta = K_a\Gamma = K_a\frac{\gamma_A^- \gamma_H^+}{\gamma_{HA}}=\frac{[A^-][H^+]}{[HA]}\frac{\gamma_A^- \gamma_H^+}{\gamma_{HA}}\] <p>where \(\Gamma\) is the activity quotient for the reaction. Henry’s and Raoult’s law are used to provide a estimates of the activity coefficient.</p> <h2 id="proton-affinity">Proton Affinity</h2> <p>Note that Ka requires the knowledge of the enthalpic, entropic, and solvation contributions during the dissociation of an acid. A simple metric based on purely the enthalpic components is the proton affinity defined as:</p> \[HA_{(g)} \rightarrow A^-_{(g)} + H^+_{(g)}\] <p>where all species are in the gas-phase rather than bulk solution. This is proton affinity is also known as gas-phase basicity. The proton affinity (a positive value) measures the intrinsic property of a molecule given as:</p> \[E_{PA}=E_{A^-_{(g)}} + E_{H^+_{(g)}} - E_{HA_{(g)}}\] <p>where larger proton affinities, (More stable HA and less stable \(A^-\) ) means stronger base or weaker acid. Note that the energies of each species are not written as free energies.</p> <h1 id="equilibrium-potentials-of-anion-specific-adsorption">Equilibrium Potentials of Anion Specific Adsorption</h1> <p>Specific adsorption of anions are dependent on the pH of the solution. We derive the equilibrium adsorption potential for both high and low pH solutions relative to the pKa of the anion of interest.</p> <h2 id="high-ph-case">High pH Case</h2> <p>When the pH is higher than the pKa, HA has dissociated into \(A^-\). Anions specifically adsorb on a metal surface describe by the following reaction:</p> \[A^-_{(aq)}+ * \rightarrow A^*_{(aq)} + e^-\] <p>where the aqueous anion undergoes electron transfer upon adsorption and (partially) desolvates. The potential-dependent free energy change of this reaction is written as the form as:</p> \[\Delta G_{ads}(U_{abs})=G_{A^*_{(aq)}} + G_{e^-} - G_{A^-_{(aq)}} - G_{*_{(aq)}}\] <p>The free energy change of the adsorbed anion, \(A^*\) is generally defined as:</p> \[G_{i_{(g)}} = E_{i,DFT} + E_{ZPVE} + TS_{vib}\] <p>where the DFT Enthalpy at 0 K is \(E_i\), the zero point energy is \(E_{ZPVE}\) , and \(TS_{vib}\) is the entropic corrections. At a first approximation, the latter two terms are determined from DFT from both a harmonic oscillator approximation and vibrational calculations.</p> <p>Approximating the solvation free energy change during specific adsorption is challenging. Here, we define the solvation free energy change for specific anion adsorption as:</p> \[\Delta\Delta G_{solv} = \Delta G_{solv,A*} -\Delta G_{solv,*} - \Delta G_{solv,A^-}\] <p>where the solvation energy of each species is generally defined as:</p> \[\Delta G_{solv,i} = G_{i_{(aq)}}-G_{i_{(g)}}\] <p>The solvation energy of \(A^-\) in theory should be potential-independent as it is in the bulk solution far away from the electrode. The solvation energy of \(A^*\) and the bare metal can be potential-dependent and are ill-defined. Here, we assume these solvation contributions are potential-independent to rewrite the free energy change of specific anion adsorption as:</p> \[\Delta G_{ads}(U_{abs})=G_{A^*_{(g)}} + G_{e^-} - G_{A^-_{(g)}} - G_{*_{(g)}}+\Delta\Delta G_{solv}\] <p>Note that the free energy of the electron is simply defined as: \(G_{e^-}=-|e|U_{abs}\) where e is the electron charge and the \(U_{abs}\) is the electrode on the absolute potential. The equilibrium potential, \(U^0\) is insightful in predicting the potential at which anions would adsorb. This occurs when the free energy change of adsorption is at zero defined as:</p> \[\Delta G_{ads}(U^0_{abs})=0=G_{A^*_{(g)}} -|e|U^0_{abs} - G_{A^-_{(g)}} - G_{*_{(g)}}+\Delta\Delta G_{solv}\] \[U^0_{abs}=\frac{G_{A^*_{(g)}} - G_{A^-_{(g)}} - G_{*_{(g)}}+\Delta\Delta G_{solv}}{|e|}\] <p>where \(U^0_{abs}\) is the equilibrium potential on the absolute scale. Experimental electrochemical measurements are not relative the absolute scale (electron in vacuum) but, for example, to the standard hydrogen electrode. The equilibrium potential on an absolute scale can simply be converted to a relevant potential by defining:</p> \[U^0_{SHE} = U^0_{abs} + \Delta U_{abs \rightarrow SHE}\] \[U^0_{SHE} =\frac{G_{A^*_{(g)}} - G_{A^-_{(g)}} - G_{*_{(g)}}+\Delta\Delta G_{solv}}{|e|} + \Delta U_{abs \rightarrow SHE}\] <p>where the conversion from U-abs to U-SHE ranges from -4.2 to 5.0 V-SHE. Finally, we have derived the equilibrium adsorption potential on an SHE from DFT for the case of high pH.</p> <h2 id="low-ph-case">Low pH Case</h2> <p>When the pH is lower than the pKa, HA is more stable in solution. Specific adsorption of the anion occurs simultaneous deprotonation and electron transfer onto a metal surface defined as:</p> \[HA_{(aq)}+ * \rightarrow A^*_{(aq)} + e^- + H^+\] <p>where the aqueous anion undergoes electron transfer upon adsorption and (partially) desolvates. The free energy change of this reaction is written as the form as:</p> \[\Delta G_{ads}(U_{abs})=G_{A^*_{(aq)}} + G_{e^-} + G_{H^+}- G_{HA_{(aq)}} - G_{*}\] \[\Delta G_{ads}(U_{abs})=G_{A^*_{(aq)}} -|e|U_{abs} + G_{H^+}- G_{HA_{(aq)}} - G_{*}\] <p>Less derivations will be shown but it is important to define the free energy of the proton. We will discuss two methods: 1) defining the energy of the proton in bulk solution and 2) the computational Hydrogen electrode.</p> <h3 id="defining-the-protons-gibbs-free-energy-she">Defining the Proton’s Gibbs Free Energy (SHE):</h3> <p>In it’s simplest form for pH-independence, the free energy of the proton in bulk solution is defined as: \(G_{H^+_{(aq)}} = G_{H^+_{(g)}} + \Delta G_{H^+,solv}\)</p> <p>This value carries uncertainty as it is highly dependent on the free energy of the proton, which is challenging to quantify experimentally and requires thermodynamic assumptions. Regardless, the equilibrium adsorption potential on an SHE scale can be calculated as</p> \[\Delta G_{ads}(U^0_{abs})= 0=G_{A^*_{(aq)}} -|e|U^0_{abs} + G_{H^+}- G_{HA_{(aq)}} - G_{*}\] \[U^0_{abs}=\frac{G_{A^*_{(aq)}} + G_{H^+}- G_{HA_{(aq)}} - G_{*}}{|e|}\] <p>which \(U^0\) can be converted to the SHE scale as defined previously.</p> <h3 id="the-computational-hydrogen-electrode-rhe">The Computational Hydrogen Electrode (RHE)</h3> <p>An alternative method to determining the free energy of the proton in bulk solution is to use the Computational Hydrogen Electrode (CHE) Approach, which uses the well-defined reversible hydrogen electrode (RHE). This defines the free energy or chemical potential of both the proton in bulk solution and electron as:</p> \[\mu_{H^+} +\mu_{e^+} = \frac{1}{2}G_{H_2,(g)} - |e|U_{RHE}\] <p>where it utilizes the fact that protons and electrons are at equilibrium with \(H_2\) gas at 0 V-RHE. The latter term accounts for the linear deviation from this 0 V-RHE.</p> <p>We can determine the equilibrium adsorption potential using the CHE approach as follows:</p> \[\Delta G_{ads}(U^0_{RHE})= 0=G_{A^*_{(aq)}} + \frac{1}{2}G_{H_2,(g)} - |e|U_{RHE}- G_{HA_{(aq)}} - G_{*}\] \[U^0_{RHE}=\frac{G_{A^*_{(aq)}} + \frac{1}{2}G_{H_2,(g)}- G_{HA_{(aq)}} - G_{*}}{|e|}\] <p>where the equilibrium adsorption potential is determined on a RHE scale. The RHE depends on the pH so conversion back to SHE is possible using the Nernst Equation:</p> \[U^0_{RHE} = U^0_{SHE} - 0.059pH\] \[U^0_{SHE} = U^0_{RHE} + 0.059pH\] <p>Now the low-pH (pH dependent) and the high pH (non-pH dependent) cases of anion adsorption can be calculated.</p> <h2 id="python-script-visualizing-anion-adsorption-using-the-equilibrium-adsorption-potential">Python Script: Visualizing Anion Adsorption using the Equilibrium Adsorption Potential</h2> <p>I have created a Google Colab link you can check out to play with a simple script to visualize anion adsorption regimes and how the equilibrium adsorption potenital relates.</p> <p><a href="https://colab.research.google.com/drive/17M9gAGZCiIyxxdshJ-f6leRZQpKLwpFI?usp=sharing">The GoogleColab Notebook can be accessed here.</a></p> <h2 id="considerations-of-the-electrochemical-double-layer-and-constant-potential">Considerations of the Electrochemical Double Layer and Constant Potential</h2> <p>Here, the simulations are performed at constant charge (fixed number of electrons), where in experimental set ups are performed at constant potential (varying number of electrons). These can be corrected using Grand Canonical DFT approaches.</p> <p>More information to learn about our Analytical Grand Canonical DFT approach can be read more at <a href="https://github.com/andrewjarkwahwong/dft-electrocatalysis-Janik">my GitHub Repository.</a></p>]]></content><author><name></name></author><category term="ion-adsorption"/><category term="anions"/><category term="DFT"/><category term="basics"/><category term="math"/><category term="electrocatalysis"/><summary type="html"><![CDATA[Calculating Equilibrium Potential of Specific Anion Adsorption]]></summary></entry><entry><title type="html">Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra</title><link href="https://andrewjarkwah.github.io/blog/2024/google-gemini-updates-flash-15-gemma-2-and-project-astra/" rel="alternate" type="text/html" title="Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra"/><published>2024-05-14T00:00:00+00:00</published><updated>2024-05-14T00:00:00+00:00</updated><id>https://andrewjarkwah.github.io/blog/2024/google-gemini-updates-flash-15-gemma-2-and-project-astra</id><content type="html" xml:base="https://andrewjarkwah.github.io/blog/2024/google-gemini-updates-flash-15-gemma-2-and-project-astra/"><![CDATA[]]></content><author><name></name></author><summary type="html"><![CDATA[We’re sharing updates across our Gemini family of models and a glimpse of Project Astra, our vision for the future of AI assistants.]]></summary></entry><entry><title type="html">Displaying External Posts on Your al-folio Blog</title><link href="https://andrewjarkwah.github.io/blog/2022/displaying-external-posts-on-your-al-folio-blog/" rel="alternate" type="text/html" title="Displaying External Posts on Your al-folio Blog"/><published>2022-04-23T23:20:09+00:00</published><updated>2022-04-23T23:20:09+00:00</updated><id>https://andrewjarkwah.github.io/blog/2022/displaying-external-posts-on-your-al-folio-blog</id><content type="html" xml:base="https://andrewjarkwah.github.io/blog/2022/displaying-external-posts-on-your-al-folio-blog/"><![CDATA[]]></content><author><name></name></author></entry></feed>